function resetGridContainer(){}function setUpFilters(a){}function loadComments(a){var b=url(-1,window.location.href),c=(doT.template($("#commodity-comments-tpl").text()),"/api/commodities/"+b+"/comments/"+a);$.get(c,function(b){setupComments(b.items),a>0&&a<parseInt(b.total)?$(".more-btn").show():$(".more-btn").hide()})}function loadRecommends(){if(startRun()){if(0>currentTotal)return $(".not-more-tips-area").fadeIn(),void stopRun();currentIndex>-1&&showLoading(),Waypoint.destroyAll(),currentIndex++;var a=10,b=url(-1,window.location.href),c=doT.template($("#commodity-recommends-tpl").text()),d="/api/commodities/"+b+"/recommends/pages/"+currentIndex,e=$(".recommends-start-area");$.get(d,function(b){var d=c(b);$(d).hide().appendTo(e).fadeIn(500);var f=$("#container");currentTotal=parseInt(b.total),(currentIndex+1)*a>currentTotal&&(currentTotal=-1),closeLoading();var g={offset:"bottom-in-view",context:f};$("#bottom-area").waypoint(function(){loadRecommends()},g),stopRun()})}}function wechatShare(){showShareTipsArea()}function iFollowIt(a,b){if(startRun()){var c="/api/users/"+a+"/follow/"+b;$.post(c,function(a){var c=$(".follower-"+b),d=c.parent(),e="animated bounceIn";c.addClass("active").html("已关注"),d.addClass(e),$(d).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){d.removeClass(e),d.html(""),stopRun()})})}}function iZanIt(){if(startRun()){var a=$("#commodity-id").val(),b="/api/commodities/"+a+"/zans",c=$("#btn-zan-link");$.post(b,function(a){c.attr("href","javascript:iCancelZanIt();");var b=c.find("i");b.removeClass("mt-like"),b.addClass("mt-liked"),b.addClass("active"),stopRun()})}}function iCancelZanIt(){if(startRun()){var a=$("#commodity-id").val(),b="/api/commodities/"+a+"/zans/cancel",c=$("#btn-zan-link");$.post(b,function(a){c.attr("href","javascript:iZanIt();");var b=c.find("i");b.removeClass("mt-liked"),b.removeClass("active"),b.addClass("mt-like"),stopRun()})}}function showExtMenu(){$("#commodity-ext-menu").show()}function hideExtMenu(){$("body").on("touchmove",function(a){$("#commodity-ext-menu").hide()})}function showComplaintView(){var a=$("#commodity-id").val(),b=$("#current-id").val(),c="/api/complaints/"+b+"/"+a+"/repeat",d="animated bounceInUp",e=$("#complaint-panel");$.get(c,function(a){if(a.item.length>0&&a.item[0].processed===!1){var b=a.item[0].reason;e.find(".default-line").remove(),$(".user-complaint-info").show().find(".user-complaint-text").html(b),$(".complaint-placeholder").html("您选择的举报原因"),e.find(".big-btn").html("举报受理中").css("background-color","#cacccb").removeAttr("onclick"),$(".accusation-checkbox").find("input").attr({readonly:"readonly",checked:"checked"})}}),e.show(),e.addClass(d),e.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.removeClass(d)})}function hideComplaintView(){var a="animated bounceOutDown",b=$("#complaint-panel");b.addClass(a),b.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){b.hide(),b.removeClass(a)})}function iComplaintIt(a,b){var c=$("#commodity-id").val(),d=$("#complaint-panel"),e=d.find("input[type=checkbox]:checked"),f="";b?f="价格不符":$.each(e,function(a,b){f+=$(b).val()+" "}),f=$.trim(f);var g="/api/complaints/new";""!==f?$.post(g,{uid:a,commodity:c,reason:f},function(a){if(b)alertAutoHideMessage("感谢您！小编一会就改好~");else{var c=d.find(".big-btn");c.css("background-color","#cacccb").html("举报受理中").removeAttr("onclick"),hideComplaintView()}}):alertMessage(MOODs.dejected,"必须选择一个原因哟~")}function showCommentEditor(a,b,c){var d="animated bounceInUp",e=$("#comment-editor"),f=$("#comment-textarea"),g=$("#comment-parent-input"),h=$("#comment-cid-input");c?(f.val("[回复: "+c+"] "),g.val(a),h.val(b)):f.val(""),e.css("height",document.body.clientHeight+"px"),e.show(),e.addClass(d),e.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.removeClass(d)})}function hideCommentEditor(a){var b="animated bounceOutDown",c=$("#comment-editor");c.addClass(b),c.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){c.hide(),c.removeClass(b),a&&a()})}function iCommentIt(){var a=$("#send-comment-btn"),b=a.attr("href");a.attr("href","###");var c=$("#commodity-id").val(),d=$.trim($("textarea#comment-textarea").val()),e=$("#comment-parent-input"),f=$("#comment-cid-input"),g="/api/commodities/"+c+"/comments",h=/^\[回复:.*\]$/g;return!d||""===d||d.match(h)?void hideCommentEditor(function(){a.attr("href",b)}):void $.post(g,{comment:d,parent:e.val(),main:f.val()},function(c){hideCommentEditor(function(){$(".not-review-text").remove(),$(".topic-comments-area").removeClass("not-review"),loadComments(5),a.attr("href",b)})})}var pageId=url(-1,window.location.href),tpl=doT.template($("#commodity-recommends-tpl").text()),pageApiUrl="/api/commodities/"+pageId+"/recommends/pages/",pageSize=8,pageAllFilters,isShowCategories=!0;$(document).ready(function(){showReturnArrow("/"),$(".not-review").length<1&&loadComments(5);var a=localStorage.getItem("withComment");"true"===a&&(localStorage.setItem("withComment",null),showCommentEditor());var b=$(".commodity-desc-area span"),c=url(-1,window.location.href);if(b.length>0){var d=$.sntext(b.html(),{debug:!1,onAt:function(a,b){return'<a href="/users/search/'+$.removeHTMLTags(b)+'" class="in-at-link">'+a+"</a>"},onTag:function(a,b){return"<a href='javascript:activityToSearch(\""+$.removeHTMLTags(b)+'", "/commodities/'+c+'")\' class="in-comment-link">'+a+"</a>"}});b.html(d)}resetGridContainer();var e=$("#complaint-panel").find("input[type=checkbox]");e.click(function(a){var b=$(a.target);b.prop("checked")&&(e.prop("checked",!1),b.prop("checked",!0))}),$(".slick-container").click(function(){var a=$(".slick-container div.images img"),b=[];$.each(a,function(c,d){(0!==c&&c!==a.length-1||1===a.length)&&b.push($(d).attr("src").replace("!content",""))}),alertSlideShowPanel(b)}),$(".slick-container").on("beforeChange",function(a,b,c,d){var e=$(".custom-tag");0===d?e.show():e.hide()}),$("#clear-touchmove").click(function(a){var b=$("#shoucang-alert-message-panel");this===a.target&&b.foundation("reveal","close")}),hideExtMenu()});var currentIndex=-1,currentTotal=8;