function showFileChoose(){return $("#user-avatar-input").click()}function checkInvitationCode(){var a=$.trim($("#signup-form").find("input[name=invitation_code]").val()),b="/api/invitation_code/"+a;return!a||a.length<1?void alertMessage(MOODs.dejected,"请填写邀请码"):void $.get(b,function(a){a&&a.code?$(".slick-container").slick("slickNext"):alertMessage(MOODs.dejected,"没找到这个邀请码哦")})}function checkMobileCode(){var a=$.trim($("#signup-form").find("input[name=mobile]").val()),b=$.trim($("#signup-form").find("input[name=code]").val()),c="/api/users/exist/mobile/"+a,d=!!a.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/);return d?($.get(c,function(a){return a.result>0?void alertMessage(MOODs.dejected,"这个手机号已经注册过啦"):void 0}),b.length<1?void alertMessage(MOODs.dejected,"请填写正确的验证码"):void $(".slick-container").slick("slickNext")):void alertMessage(MOODs.dejected,"请填写正确的手机号码")}function sendSmsCode(){var a=$("#signup-form").find("input[name=mobile]").val();if(!/^1[3|4|5|8][0-9]\d{4,8}$/.test(a))return alertMessage(MOODs.dejected,"请填写正确的手机号码"),!1;var b="/signup/code/"+a,c=$("#send-sms-btn");return c.bind("click",!1),$.get(b,function(a){1===a.code&&c.unbind("click",!1),alertMessage(MOODs.dejected,a.msg)}),!0}function submitForm(){var a=$("#signup-form"),b=a.attr("action"),c=document.getElementById("user-avatar-input").files[0],d=new FormData;return d.append("username",$("#username-input").val()),d.append("password",$("#password-input").val()),d.append("code",a.find("input[name=code]").val()),d.append("mobile",a.find("input[name=mobile]").val()),d.append("invitation_code",a.find("input[name=invitation_code]").val()),d.append("avatar",c),$("#password-input").val()?($.ajax({url:b,type:"POST",data:d,mimeType:"multipart/form-data",contentType:!1,cache:!1,processData:!1,success:function(a,b,c){a.error||(a=JSON.parse(a),"500"===a.status.toString?alertMessage(MOODs.dejected,a.msg):($("#user-id").val(a.user.id),$(".slick-container").slick("slickNext")))}}),!0):(alertMessage(MOODs.dejected,"信息不全"),!0)}function submitForm2(){var a=$("#user-id").val(),b=$("#child_sex").val(),c=$(".sel_year").val(),d=$(".sel_month").val(),e=$(".sel_day").val(),f=c+"-"+d+"-"+e;f=new Date(f);var g=[];$("span.show").each(function(a,b){g.push($(b).attr("date-id"))}),$.ajax({url:"/api/users/"+a+"/hobbies",type:"POST",data:{sex:b,hobbies:g,birthday:f},success:function(a,b,c){a.error||(window.location.href="/")}})}function tianchong(a,b,c){function d(){if(0===a.val()||0===b.val())c.html("");else{c.html("");var d=parseInt(a.val()),e=parseInt(b.val()),f=0;switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:f=31;break;case 4:case 6:case 9:case 11:f=30;break;case 2:f=28,(d%4===0&&d%100!==0||d%400===0)&&(f=29)}for(var g=c.attr("rel"),h=1;f>=h;h++){var i=g===h?"selected":"",j='<option value="'+h+'" '+i+">"+h+"</option>";c.append(j)}}}var e,f,g=(new Date).getFullYear(),h=parseInt((new Date).getMonth())+1,i=(new Date).getDate();for(e=g;e>=1980;e--){f=g===e?"selected":"";var j='<option value="'+e+'"'+f+">"+e+"</option>";a.append(j)}for(e=1;12>=e;e++){f=h===e?"selected":"";var k='<option value="'+e+'"'+f+">"+e+"</option>";b.append(k)}for(e=1;31>=e;e++){f=i===e?"selected":"";var l='<option value="'+e+'"'+f+">"+e+"</option>";c.append(l)}""!==c.attr("rel")&&d()}$(function(){var a="/api/tags/list/user_hobbies",b=doT.template($("#hobby-tpl").html());$.get(a,function(a){var c=b(a),d=$(".slick_content_like ul");d.html(c)}),tianchong($(".sel_year"),$(".sel_month"),$(".sel_day")),$(".slick_content_like ul").on("click","li",function(){$(this).find(".icon").hasClass("show")?($(this).find(".icon").removeClass("show"),$(this).find(".mengceng").addClass("zhezhao"),$(this).find(".signup-thumb").css("backgroundSize","120%")):($(this).find(".icon").addClass("show"),$(this).find(".mengceng").removeClass("zhezhao"),$(this).find(".signup-thumb").css("backgroundSize","100%"))}),$(".slick_content_head_down .img").click(function(){var a=$(this).attr("data-id");$("#child_sex").val(a),$(".img .icon").hide(),$(this).find(".icon").show()})}),$(document).ready(function(){showReturnArrow("javascript:window.history.back();"),$("body").css("background-color","#f7f7f7");new ImagePreview("#user-avatar-input",{placeholder:"#user-avatar-img",callback:function(){$("#user-avatar-img").find("> img").click(function(){showFileChoose()})}})});