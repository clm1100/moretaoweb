function setupComments(a){var b=$(".comments-area"),c=doT.template($("#comments-tpl").text()),d=c({items:a});d=$.sntext(d,{debug:!1,onAt:function(a,b){return'<a href="/users/search/'+$.removeHTMLTags(b)+'" class="in-at-link">'+a+"</a>"},onTag:function(a,b){return'<a href="/search/activity/'+$.removeHTMLTags(b)+'" class="in-comment-link">'+a+"</a>"}}),b.html(""),$(d).hide().appendTo(b).fadeIn(500)}function showFindUserEditor(a){var b="/api/users/"+a+"/friends",c="animated bounceInUp",d=$("#find-user-editor"),e=doT.template($("#at-friend-tpl").text());$(".comment-search-input").val(""),d.css("height",document.body.clientHeight+"px"),d.show(),d.addClass(c),$.get(b,function(a){for(var b=a.followers.items,c=a.fans.items,d=b.concat(c),f=[],g=0;g<d.length;g++)-1===f.indexOf(d[g])&&f.push({name:d[g].nickname,icon:d[g].icon});var h=e(f);$("#friend-list").html(h)}),d.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){d.removeClass(c)})}function newFriendClick(){atFriend($("#friend-input").val()),hideFindActivityEditor()}function hideFindUserEditor(a){var b="animated bounceOutDown",c=$("#find-user-editor");c.addClass(b),c.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){c.hide(),c.removeClass(b),a&&a()})}function showFindActivityEditor(){var a="/api/activities/hots/10",b="animated bounceInUp",c=$("#find-activity-editor"),d=doT.template($("#activity-tpl").text());$(".comment-search-input").val(""),c.css("height",document.body.clientHeight+"px"),c.show(),c.addClass(b),$.get(a,function(a){var b=d(a);$("#activity-list").html(b)}),c.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){c.removeClass(b)})}function newActivityClick(){activityClick($("#activity-input").val()),hideFindActivityEditor()}function hideFindActivityEditor(a){var b="animated bounceOutDown",c=$("#find-activity-editor");c.addClass(b),c.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){c.hide(),c.removeClass(b),a&&a()})}function atFriend(a){var b=a,c=$("#comment-textarea").val();$("#comment-textarea").val(c+" @"+b+" "),hideFindUserEditor()}function activityClick(a){var b=a,c=$("#comment-textarea").val();$("#comment-textarea").val(c+"#"+b+"#"),hideFindActivityEditor()}